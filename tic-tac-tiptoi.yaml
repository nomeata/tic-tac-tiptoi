product-id: 909
comment: Tic Tac Toe for the Tiptoi
init: $p1 := 0 $p2 := 0 $turn := 1
welcome: welcome, player1
language: de

scripts:
  feldUR: $bit := 0o001 J(selected)
  feldUM: $bit := 0o002 J(selected)
  feldUL: $bit := 0o004 J(selected)
  feldMR: $bit := 0o010 J(selected)
  feldMM: $bit := 0o020 J(selected)
  feldML: $bit := 0o040 J(selected)
  feldOR: $bit := 0o100 J(selected)
  feldOM: $bit := 0o200 J(selected)
  feldOL: $bit := 0o400 J(selected)

  selected: $p1bit := $bit $p1bit &= $p1 $p2bit := $bit $p2bit &= $p2 J(place)

  place:
  - $p1bit != 0? P(here_cross) J(next)
  - $p2bit != 0? P(here_circle) J(next)
  - $turn == 1? $p1 |= $bit $turn := 2 P(here_now_cross) J(win_check)
  - $turn == 2? $p2 |= $bit $turn := 1 P(here_now_circle) J(win_check)

  win_check: $p1won := 0 $p2won := 0 J(win_check1)

  win_check1: $mask := 0o007 $tmp1 := $p1 $tmp1 &= $mask $tmp2 := $p2 $tmp2 &= $mask J(win_check1a)
  win_check1a:
  - $tmp1 == $mask? J(player1wins)
  - $tmp2 == $mask? J(player2wins)
  - J(win_check2)
  win_check2: $mask := 0o070 $tmp1 := $p1 $tmp1 &= $mask $tmp2 := $p2 $tmp2 &= $mask J(win_check2a)
  win_check2a:
  - $tmp1 == $mask? J(player1wins)
  - $tmp2 == $mask? J(player2wins)
  - J(win_check3)
  win_check3: $mask := 0o700 $tmp1 := $p1 $tmp1 &= $mask $tmp2 := $p2 $tmp2 &= $mask J(win_check3a)
  win_check3a:
  - $tmp1 == $mask? J(player1wins)
  - $tmp2 == $mask? J(player2wins)
  - J(win_check4)
  win_check4: $mask := 0o111 $tmp1 := $p1 $tmp1 &= $mask $tmp2 := $p2 $tmp2 &= $mask J(win_check4a)
  win_check4a:
  - $tmp1 == $mask? J(player1wins)
  - $tmp2 == $mask? J(player2wins)
  - J(win_check5)
  win_check5: $mask := 0o222 $tmp1 := $p1 $tmp1 &= $mask $tmp2 := $p2 $tmp2 &= $mask J(win_check5a)
  win_check5a:
  - $tmp1 == $mask? J(player1wins)
  - $tmp2 == $mask? J(player2wins)
  - J(win_check6)
  win_check6: $mask := 0o444 $tmp1 := $p1 $tmp1 &= $mask $tmp2 := $p2 $tmp2 &= $mask J(win_check6a)
  win_check6a:
  - $tmp1 == $mask? J(player1wins)
  - $tmp2 == $mask? J(player2wins)
  - J(win_check7)
  win_check7: $mask := 0o124 $tmp1 := $p1 $tmp1 &= $mask $tmp2 := $p2 $tmp2 &= $mask J(win_check7a)
  win_check7a:
  - $tmp1 == $mask? J(player1wins)
  - $tmp2 == $mask? J(player2wins)
  - J(win_check8)
  win_check8: $mask := 0o421 $tmp1 := $p1 $tmp1 &= $mask $tmp2 := $p2 $tmp2 &= $mask J(win_check8a)
  win_check8a:
  - $tmp1 == $mask? J(player1wins)
  - $tmp2 == $mask? J(player2wins)
  - J(next)


  player1wins: P(player1wins) $p1 := 0 $p2 := 0 $turn := 2 J(next)
  player2wins: P(player2wins) $p1 := 0 $p2 := 0 $turn := 1 J(next)

  next:
  - $turn == 1? P(player1)
  - $turn == 2? P(player2)

speak:
  welcome: "Willkommen bei Tic-Tac-Tiptoi."
  player1: "Kreuz ist dran."
  player2: "Kreis ist dran."
  here_cross: "Hier ist schon ein Kreuz"
  here_circle: "Hier ist schon in Kreis"
  here_now_cross: "Hier ist jetzt ein Kreuz"
  here_now_circle: "Hier ist jetzt ein Kreis"
  player1wins: "Kreuz gewinnt."
  player2wins: "Kreis gewinnt."
